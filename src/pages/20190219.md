---
date: '2019-02-19'
title: 配列をn個ずつの配列に分割してそれをまとめた配列を作る
tags: ['JavaScript']
description: '配列をn個ずつの配列に分割してそれをまとめた配列を作る'
---

## したいこと
JavaScriptでRubyのeach_sliceと同じことをしたい。
```javascript
[1, 2, 3, 4, 5, 6] => [[1, 2], [3, 4], [5, 6]]
```

### 再帰(破壊的)

```javascript
const eachSlice = (arr, separate = 2, result = []) => {
  if (arr.length === 0) {
    return result
  }

  return eachSlice(arr, separate, [...result, arr.splice(0, separate)])
}

or

const eachSlice = (arr, separate = 2, result = []) => {
  if (arr.length === 0) {
    return result;
  }

  result.push(arr.splice(0, separate))
  return eachSlice(arr, separate, result)
}
```

配列の要素数が16000くらいでスタックオーバーフローが発生するので注意。

### 再帰(非破壊的)

```javascript
const eachSliceExecute = (arr, separate = 2, result = []) => {
  if (arr.length === 0) {
    return result
  }

  return eachSliceExecute(arr, separate, [...result, arr.splice(0, separate)])
}

const eachSlice = (arr, separate) => {
  return eachSliceExecute([...arr], separate)
}
```


## While
```javascript
const eachSlice = (arr, separate = 2) => {
  let dupArray = [...arr]
  let result = [];
  let length = dupArray.length;

  while (0 < length) {
    result.push(dupArray.splice(0, separate));
    length = dupArray.length
  }

  return result;
};
```

スタックオーバーフローを回避したいなら。

###おまけ
#### カリー化

```javascript
const eachSlice = separate => {
  return function(arr) {
    return eachSliceExecute([...arr], separate)
  }
}
```

[CodeSandbox](https://codesandbox.io/s/73pxxmyvq0?expanddevtools=1&view=editor)

参考
* [配列を n 個ずつの配列に分割して、それをまとめた配列を作る | Unformed Building](http://unformedbuilding.com/articles/javascript-array-practice-1/)
* [配列をn個ずつの配列に分割してそれをまとめた配列を作る | ポケットがチケットでいっぱい](http://fukuchiharuki.me/wiki/index.php?JavaScript/%E9%85%8D%E5%88%97%E3%82%92n%E5%80%8B%E3%81%9A%E3%81%A4%E3%81%AE%E9%85%8D%E5%88%97%E3%81%AB%E5%88%86%E5%89%B2%E3%81%97%E3%81%A6%E3%81%9D%E3%82%8C%E3%82%92%E3%81%BE%E3%81%A8%E3%82%81%E3%81%9F%E9%85%8D%E5%88%97%E3%82%92%E4%BD%9C%E3%82%8B)